#!/usr/bin/env python3
"""
Garcia Family Medicine - Netlify Form Updater
This script automatically updates your index.html file with Netlify form configuration
"""

def update_html_form(input_file='index.html', output_file='index_UPDATED.html'):
    """Update the HTML file to use Netlify Forms"""
    
    # The old Formspree form tag to replace
    OLD_FORM = '<form action="https://<form name="contact" method="POST" data-netlify="true" netlify-honeypot="bot-field">
                        <input type="hidden" name="form-name" value="contact">
                        <p style="display:none;">
                            <label>Don't fill this out if you're human: <input name="bot-field" /></label>
                        </p>/f/YOUR_FORM_ID" method="POST">'
    
    # The new Netlify form with spam protection
    NEW_FORM = '''<form name="contact" method="POST" data-netlify="true" netlify-honeypot="bot-field">
                        <input type="hidden" name="form-name" value="contact">
                        <p style="display:none;">
                            <label>Don't fill this out if you're human: <input name="bot-field" /></label>
                        </p>'''
    
    print("üîß Garcia Family Medicine - Netlify Form Updater")
    print("=" * 60)
    
    try:
        # Read the HTML file
        print(f"üìñ Reading {input_file}...")
        with open(input_file, 'r', encoding='utf-8') as f:
            html_content = f.read()
        
        # Check if the old form exists
        if OLD_FORM not in html_content:
            print("‚ùå ERROR: Could not find the Formspree form in your HTML.")
            print("   Your form may already be updated or the file is different.")
            return False
        
        # Make the replacement
        print("üîÑ Updating form configuration...")
        updated_html = html_content.replace(OLD_FORM, NEW_FORM)
        
        # Write the updated file
        print(f"üíæ Saving updated file as {output_file}...")
        with open(output_file, 'w', encoding='utf-8') as f:
            f.write(updated_html)
        
        print("\n‚úÖ SUCCESS! Your HTML has been updated!")
        print("=" * 60)
        print(f"\nüìÑ Updated file saved as: {output_file}")
        print("\nüìß Next Steps:")
        print("   1. Upload the updated file to Netlify")
        print("   2. Go to Netlify Dashboard ‚Üí Forms")
        print("   3. Click 'Form notifications'")
        print("   4. Add email: admin@garciafamilymedicine.care")
        print("   5. Test your contact form!")
        print("\n‚ú® Your form will now send to admin@garciafamilymedicine.care")
        print("=" * 60)
        
        return True
        
    except FileNotFoundError:
        print(f"‚ùå ERROR: Could not find {input_file}")
        print("   Make sure the file is in the same folder as this script.")
        return False
        
    except Exception as e:
        print(f"‚ùå ERROR: {str(e)}")
        return False


if __name__ == "__main__":
    import sys
    import os
    
    # Check if a filename was provided
    if len(sys.argv) > 1:
        input_file = sys.argv[1]
    else:
        input_file = 'index.html'
    
    # Check if file exists
    if not os.path.exists(input_file):
        print(f"\n‚ùå ERROR: '{input_file}' not found!")
        print(f"\nUsage:")
        print(f"  python3 {sys.argv[0]} [filename]")
        print(f"\nExamples:")
        print(f"  python3 {sys.argv[0]}              (uses index.html)")
        print(f"  python3 {sys.argv[0]} myfile.html  (uses myfile.html)")
        sys.exit(1)
    
    # Run the update
    success = update_html_form(input_file)
    sys.exit(0 if success else 1)
